"""
SID History Injectors
Multiple methods for injecting SID history
"""

from .base import BaseInjector
from .mimikatz import MimikatzInjector
from .impacket import ImpacketInjector

__all__ = [
    "BaseInjector",
    "MimikatzInjector",
    "ImpacketInjector",
    "get_available_injectors"
]


def get_available_injectors() -> dict:
    """
    Get dictionary of available injectors

    Returns:
        Dict mapping name to injector class
    """
    injectors = {
        "mimikatz": MimikatzInjector,
        "impacket": ImpacketInjector,
    }

    available = {}
    for name, cls in injectors.items():
        instance = cls(verbose=False)
        if instance.is_available():
            available[name] = cls

    return available