"""
Trust Key Extractors
Multiple methods for extracting AD trust keys
"""

from .base import BaseExtractor
from .mimikatz import MimikatzExtractor
from .secretsdump import SecretsdumpExtractor

__all__ = [
    "BaseExtractor",
    "MimikatzExtractor",
    "SecretsdumpExtractor",
    "get_available_extractors"
]


def get_available_extractors() -> dict:
    """
    Get dictionary of available extractors

    Returns:
        Dict mapping name to extractor class
    """
    extractors = {
        "mimikatz": MimikatzExtractor,
        "secretsdump": SecretsdumpExtractor,
    }

    available = {}
    for name, cls in extractors.items():
        instance = cls(verbose=False)
        if instance.is_available():
            available[name] = cls

    return available