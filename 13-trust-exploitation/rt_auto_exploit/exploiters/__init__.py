"""
Trust Exploiters
"""

from .base import BaseExploiter
from .parent_child import ParentChildExploiter
from .forest_trust import ForestTrustExploiter

__all__ = [
    "BaseExploiter",
    "ParentChildExploiter",
    "ForestTrustExploiter",
    "get_exploiter_for_method"
]


def get_exploiter_for_method(method: str):
    """
    Get appropriate exploiter class for method

    Args:
        method: Exploitation method string

    Returns:
        Exploiter class or None
    """
    method_lower = method.lower()

    if "raise_child" in method_lower or "parent_child" in method_lower or "sid_history" in method_lower:
        return ParentChildExploiter
    elif "trust_key" in method_lower or "forest" in method_lower:
        return ForestTrustExploiter

    return None