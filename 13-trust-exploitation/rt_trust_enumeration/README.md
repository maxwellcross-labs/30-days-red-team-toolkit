# RT Trust Enumeration Framework

**Active Directory Trust Relationship Mapper**

Part of the **30 Days of Red Team** toolkit by Maxwell Cross.

## Overview

A modular Python framework for enumerating and analyzing Active Directory trust relationships. Identifies attack paths through parent-child trusts, forest trusts, and external trusts.

## Features

- **Multiple Enumeration Methods**: PowerView, LDAP, Impacket
- **Cross-Platform**: LDAP method works from Linux/Mac
- **Attack Path Analysis**: Automatic identification of exploitation opportunities
- **Visual Trust Maps**: ASCII, Mermaid, and Graphviz outputs
- **Comprehensive Reporting**: JSON reports with executive summaries

## Installation

```bash
# Clone the toolkit
git clone https://github.com/maxwellcross-labs/30-days-redteam.git
cd 30-days-redteam/rt_trust_enumeration

# Install dependencies
pip install ldap3
```

## Quick Start

```bash
# Run with all available methods
python -m rt_trust_enumeration -d corp.local -u admin -p 'P@ssw0rd'

# LDAP only (works from Linux)
python -m rt_trust_enumeration -d corp.local -m ldap -u admin -p 'P@ssw0rd'

# Specify domain controller
python -m rt_trust_enumeration -d corp.local --dc 192.168.1.10 -u admin -p 'P@ssw0rd'
```

## Project Structure

```
rt_trust_enumeration/
├── __init__.py              # Package initialization
├── __main__.py              # Module entry point
├── cli.py                   # Command-line interface
├── framework.py             # Main orchestrator
├── models/
│   ├── __init__.py
│   └── trust.py             # Trust data models
├── enumerators/
│   ├── __init__.py
│   ├── base.py              # Base enumerator class
│   ├── powerview.py         # PowerView enumeration
│   ├── ldap_enum.py         # LDAP enumeration
│   └── impacket_enum.py     # Impacket enumeration
├── analysis/
│   ├── __init__.py
│   ├── attack_paths.py      # Attack path identification
│   └── visualizer.py        # Trust visualization
├── reporters/
│   ├── __init__.py
│   └── json_reporter.py     # Report generation
└── utils/
    ├── __init__.py
    └── converters.py        # Trust attribute converters
```

## Programmatic Usage

```python
from rt_trust_enumeration import TrustEnumerationFramework

# Initialize
framework = TrustEnumerationFramework(output_dir="./results")

# Enumerate trusts
framework.enumerate_all(
    domain="corp.local",
    username="admin",
    password="P@ssw0rd"
)

# Analyze attack paths
attack_paths = framework.identify_attack_paths()

# Generate report
framework.generate_report()

# Access trust data
for trust in framework.trusts.trusts:
    print(f"{trust.source_domain} -> {trust.target_domain}")
    print(f"  Exploitable: {trust.is_exploitable}")
```

## Enumeration Methods

| Method | Platform | Requirements | Best For |
|--------|----------|--------------|----------|
| PowerView | Windows | PowerView.ps1 | Full-featured enumeration |
| LDAP | Any | ldap3 library | Cross-platform, reliable |
| Impacket | Any | Impacket tools | Remote from Linux |

## Output Files

- `trust_report.json` - Full JSON report
- `executive_summary.txt` - High-level findings
- `trust_map.mmd` - Mermaid diagram
- `trust_map.dot` - Graphviz DOT format
- `trust_map.txt` - ASCII visualization

## Attack Path Detection

The framework automatically identifies:

- **SID History Injection** (Parent-Child trusts)
- **ExtraSids Attacks** (Cross-domain)
- **Trust Key Exploitation** (Forest trusts)
- **SID Filtering Bypass** (Misconfigured trusts)

## MITRE ATT&CK Mapping

| Technique | ID |
|-----------|-----|
| Golden Ticket | T1558.001 |
| SID-History Injection | T1134.005 |
| Pass the Ticket | T1550.001 |
| Kerberoasting | T1558.003 |

## Legal Disclaimer

This tool is intended for authorized security testing only. Always obtain written permission before conducting penetration tests. Unauthorized access to computer systems is illegal.

## Author

**Maxwell Cross**  
30 Days of Red Team Series  
[Medium](https://medium.com/@maxwellcross) | [GitHub](https://github.com/maxwellcross-labs)