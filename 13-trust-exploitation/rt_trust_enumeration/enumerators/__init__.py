"""
Trust Enumerators
Multiple methods for enumerating AD trust relationships
"""

from .base import BaseEnumerator
from .powerview import PowerViewEnumerator
from .ldap_enum import LDAPEnumerator
from .impacket_enum import ImpacketEnumerator

__all__ = [
    "BaseEnumerator",
    "PowerViewEnumerator",
    "LDAPEnumerator",
    "ImpacketEnumerator",
    "get_available_enumerators"
]


def get_available_enumerators() -> dict:
    """
    Get dictionary of available enumerators

    Returns:
        Dict mapping name to enumerator class for available methods
    """
    enumerators = {
        "powerview": PowerViewEnumerator,
        "ldap": LDAPEnumerator,
        "impacket": ImpacketEnumerator,
    }

    available = {}
    for name, cls in enumerators.items():
        instance = cls(verbose=False)
        if instance.is_available():
            available[name] = cls

    return available